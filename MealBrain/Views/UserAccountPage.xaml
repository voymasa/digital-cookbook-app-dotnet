<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MealBrain.Views.UserAccountPage"
             x:Name="ThisPage"
             Title="Create Account">
    <ContentPage.Resources>
        <Style TargetType="Entry">
            <Setter Property="TextColor" Value="Black" />
            <Setter Property="BackgroundColor" Value="White" />
            <Setter Property="PlaceholderColor" Value="#888" />
        </Style>
    </ContentPage.Resources>
    <ScrollView>
        <VerticalStackLayout Padding="30,0" Spacing="25">

            <!-- Form Section -->
            <Frame CornerRadius="12" Padding="20" BackgroundColor="#fafafa" BorderColor="#ccc">
                <VerticalStackLayout Spacing="20">
                    <!--  Icon Preview -->
                    <Frame CornerRadius="64" Padding="0" HasShadow="False"
						   HeightRequest="128" WidthRequest="128" HorizontalOptions="Center"
						   BackgroundColor="#eee">
                        <Image x:Name="AccountIconPreview"
							   Source="{Binding SelectedImagePath}"
							   Aspect="AspectFit" />
                    </Frame>
                    <Button Text="Upload Icon"
							Command="{Binding SelectImageCommand}"
							HorizontalOptions="Center" />
                    <Label Text="PNG or JPG, 128x128 or 256x256"
						   FontSize="10"
						   TextColor="#888"
						   HorizontalOptions="Center" />
                   
                    <!-- Preloaded Icons Section -->
                    <Button Text="Clear Image"
                        Command="{Binding ClearImageCommand}"
                        HorizontalOptions="Center"
                        BackgroundColor="Gray"
                        TextColor="White"
                        Margin="0,10,0,10" />
                    <Label Text="Or select a preset icon:"
                           FontSize="12"
                           HorizontalOptions="Center" />
                    <CollectionView ItemsSource="{Binding PreloadedIcons}"
                                    HeightRequest="80"
                                    HorizontalOptions="Center">
                        
                           
                        <CollectionView.ItemsLayout>
                            <LinearItemsLayout Orientation="Horizontal" 
                                               ItemSpacing="10" />
                        </CollectionView.ItemsLayout>
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Frame Style="{StaticResource IconCardStyle}" 
                                       CornerRadius="32" 
                                       WidthRequest="64" 
                                       HeightRequest="64"
                                       Padding="0"
                                       BackgroundColor="#eee">
                                    <Image Source="{Binding .}" 
                                           Aspect="AspectFit">
                                        <Image.GestureRecognizers>
                                            <TapGestureRecognizer 
                                                Tapped="OnPreloadedIconTapped"
                                                CommandParameter="{Binding .}" />
                                        </Image.GestureRecognizers>
                                    </Image>
                                </Frame>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                
                    <!-- Input Fields -->
                    <Entry Placeholder="First Name" 
                           Text="{Binding FirstName}" />
                    <Entry Placeholder="Last Name" 
                           Text="{Binding LastName}" />
                    <Entry Placeholder="Display Name" 
                           Text="{Binding DisplayName}" />
                    <Entry Placeholder="Email Address" 
                           Text="{Binding Email}"
                           Keyboard="Email" />

					<!-- Account Type -->
					<Label Text="Account Type:" TextColor="{StaticResource Primary}"/>
					<HorizontalStackLayout>
						<RadioButton Content="Personal"
                                     TextColor="{StaticResource Primary}"
									 GroupName="AccountType"
									 IsChecked="False"
									 CheckedChanged="OnAccountTypeChanged" />
						<!-- Future account types:
                        RadioButton Content="Business" 
                        GroupName="AccountType"
                        CheckedChanged="OnAccountTypeChanged" />
    -->
					</HorizontalStackLayout>

                    <!-- Buttons -->
                    <HorizontalStackLayout Spacing="20">
                        <Button Text="Save" Command="{Binding SaveCommand}" BackgroundColor="#4CAF50" TextColor="Black" />
                        <Button Text="Cancel" Command="{Binding CancelCommand}" BackgroundColor="#f44336" TextColor="Black" />
                    </HorizontalStackLayout>

                </VerticalStackLayout>
            </Frame>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>